{{- define "main" }}


  <div class="max-w-screen-lg p-4 mx-auto grid grid-cols-1 gap-12 mb-5">
    {{/*  Header classes  */}}
    {{ $headerClass := split "bg-gradient-to-r from-cyan-500 to-cyan-800 text-neutral-100" " " }} 
    {{ with or (.Param "twClasses.headerBackgroundFrameOuter") (.Param "headerGradientClasses") }}
    {{ $headerClass = split . " " }}
    {{ end }}
    {{ $headerClass = delimit $headerClass " " }}
    {{/*  Set up the content loop  */}}
    {{- $pages := slice }}
    {{- $pages = .Site.Pages }} 
    {{- $features := where $pages "Params.homeFeature" "eq" true }}
    {{ $counter := 0 }}
    {{ if (.Param "contentTopBox") }}
      <div class="h-full first:sm:col-span-2 items-center rounded-2xl bg-sky-50 transition-[filter] hover:brightness-90 dark:text-gray-200 text-gray-800 dark:bg-sky-800 dark:hover:brightness-110">
        <div class="hpContent prose max-w-max p-5 text-lg ">
          {{ .Content }}
        </div>
      </div>
    {{ end }}
    {{- range first 3 $features }}
    {{ partial "card-category-color.html" . }} 
    {{- end }}
  </div>
  
  {{ if or .Title .Content }}
    <div class="p-4 flex-1 items-center justify-center">
      {{ partial "card-category-color.html" . }}
    </div>
  {{ end }}

  <div class="lg:grid-cols-2  p-4 mx-auto grid grid-cols-1 gap-12  mb-5">
  {{/*  Finally spit out everything here! all content newest first recursive  */}}
  <h2 class="lg:col-span-2 flex p-3 items-center mb-2 text-3xl uppercase">Latest stuff</h2>
  {{/*  {{- $recent := where $pages "Summary" "!=" "" }}   */}}
  {{/*  {{- $recentWithSummary := where $pages "Summary" "!=" "" -}}
  {{- $filteredPages := slice -}}
  {{- range $recentWithSummary -}}
  {{- $categories := .Params.categories -}}
  {{- if not (in $categories "catalog") -}}
    {{- $filteredPages = $filteredPages | append . -}}
    {{- end -}}
  {{- end -}}  */}}
    
  {{- $filteredPages := slice -}}
  {{- range $pages.ByLastmod.Reverse }}
    {{ with (in .Params.categories "catalog") }} 
      {{ continue }}
    {{ end }}
    {{ if eq .Summary "" }}
      {{ continue }}
    {{ end }}
    {{- $filteredPages = $filteredPages | append . -}}
  {{ end }}

  {{- range $filteredPages.Limit 20 }}
    {{ partial "card-category-color.html" . }}
  {{ end }}
  </div>
    
{{- end }}
